#  JetBrainsRuntime Xcode Project

Этот проект для Xcode позволяет отлаживать нативную реализацию JDK для MacOS

## Сборка

1. Клонируйте репазиторий:
    ```Bash
    $ git clone -recorsive https://github.com/savoptik/JetBrainsRuntime_XCode_project.git
    ```
1. Убедитесь, что в [скрипте](SetConfig.sh) распложение JDK соответствует тому, которое у вас. Иначе измените его.
1. ВыБерите схему запуска "SetConfiguration" и запустите сборку. XCode установит конфигурации для сборки JDK.
1. Выберите подходящую вам конфигурацию JDK из списка сборочных схем, если схем нет, то выберите "добавить конфигурацию" и выберите цель сборки, соответствующую вашим потребностям;
1. Запустите сборку. XCode отобразит ошибки и предупреждения обычным способом.

### Внимание

Если при клонирование отсутствовал пораметр --recursive,скрипт SetConfiguration клонирует JBR сам по HTTPS, для разработки может понадобится изменить remote на SSH, а так же перезапустить xcode, т.к. xcode может решить, что файлы отсутствуют на диске.

## Разработка

1. добавьте папку с необходимыми вам исходниками в цель сборки "AutoComplition", это позволит xcode автодополнять код, по умолчанию добавлена папка ```src/java.desktop/macosx/native```;


## Отладка

### Отладка с перекомпиляцией семпла

Отлаживать код JDK можно разными способами, если вы хотите вашь java sempl перекомпилировать при каждом запуске, то следуйте инструкциям ниже, иначе переходите к следующему заголовку.

1. создайте в xcode новую цель с внешними инструментами сборки;
1. в поле Build Tool укажите путь, к примеру, к джава компилятору:
    ```
    JetBrainsRuntime/build/macosx-x86_64-normal-server-release/jdk/bin/javac
    ```
1. в поле Arguments укажите аргументы для компилятора
    ```
    -d build path/to/yor/main.java
    ```
1. Установите флажок "Pass build settings in environment".";
1. Собирите соответствующую схему запуска.

### Запуск и отладка

Если вы создавали цель сборки, то отредактируйте её схему запуска, иначе отредактируйте схему запуска JBR debug, или JBR  следующим образом:

1. выберите в боковом меню "Run";
1. На вкладке "info" задайте "Executable" исполняемый файл "java" из собраной вами только что JBR;
1. На вкладке "Arguments" задайте обязательно -cp, и исполняемый класс;
1. Запустите отредактированную схему.

Если вы установили флажок "Debug executable", то java запустится в LLDB, и сразу остановится, скажите тогда LLDB следующее
```LLDB
[lldb] pro hand -p true -s false SIGSEGV SIGBUS
```
После чего возабновите выполнение.

Параметры можно менять, но обязательно проверяйте на работоспособность и задавайте пути правильно.
